# So-Yummy Backend API Документація

## Зміст

- [Вступ](#вступ)
- [Архітектура](#архітектура)
- [Документація API](#документація-api)
  - [Точки доступу](#точки-доступу)
  - [Аутентифікація та авторизація](#аутентифікація-та-авторизація)
  - [Приклади запитів та відповідей](#приклади-запитів-та-відповідей)
  - [Обробка помилок](#обробка-помилок)
- [Моделі даних та схема бази даних](#моделі-даних-та-схема-бази-даних)
- [Версіювання API](#версіювання-api)
- [Підтримка та контактна інформація](#підтримка-та-контактна-інформація)
- [Ліцензія та умови використання](#ліцензія-та-умови-використання)

## Вступ:

API So-Yummy Backend дозволяє користувачам керувати рецептами, додавати нові і створювати список покупок на основі інгредієнтів рецептів. Воно служить джерелом даних для swaggerUI.

Застосунок написаний за допомогою Node.js з Express.js як веб-фреймворком, і він використовує базу даних MongoDB для зберігання даних.

## Архітектура:

API So-Yummy Backend відповідає типовій архітектурі з трьома рівнями:

1. Рівень представлення: swaggerUI, який показує деталі точок доступу API.
2. Рівень додатку: додаток Express.js, який обробляє вхідні запити і керує бізнес-логікою.
3. Рівень даних: база даних MongoDB, яка зберігає і відновлює дані.

### Технологічний стек

- Node.js: середовище виконання для запуску серверної частини.
- Express.js: веб-фреймворк для обробки запитів та відповідей API.
- MongoDB: база даних NoSQL для зберігання і отримання даних.
- Mongoose: інструмент моделювання об'єктів MongoDB для взаємодії з базою даних.

## Документація API:

API є RESTful і відповідає принципам методів та статусних кодів HTTP. Він приймає і повертає дані у форматі JSON.

#### Базовий URL: https://so-yummi.onrender.com

### Точки доступу:

#### Користувачі:

- **POST /api/users/register**: Зареєструвати користувача.
- **GET /api/users/verify/{verificationToken}**: Підтвердити обліковий запис користувача.
- **POST /api/users/verify**: Перевірте обліковий запис користувача, якщо листа з підтвердженням не знайдено.
- **POST /api/users/login**: Увійти до облікового запису користувача.
- **POST /api/users/logout**: Вийти з облікового запису користувача.
- **GET /api/users/current**: Перевірте, чи є токен дійсним.
- **PATCH /api/users/update**: Оновити обліковий запис користувача.
- **POST /api/users/subscription**: Підписатися на розсилку новин.

#### Інгредієнти:

- **GET /api/ingredients/list**: Отримати список всіх інгредієнтів.
- **GET /api/ingredients?q=інгредієнт**: Отримати рецепт за інгредієнтом.

#### Рецепти:

- **GET /api/recipes/search?q=заголовок**: Отримати рецепт за назвою.
- **GET /api/recipes/main-page**: Отримати список рецептів, впорядкованих за категоріями.
- **GET /api/recipes/categories/{category}**: Отримати список рецептів за категорією.
- **GET /api/recipes/own**: Отримати список власних створених рецептів.
- **POST /api/recipes/own**: Створити новий рецепт.
- **DELETE /api/recipes/own**: Видалити рецепт за ID.
- **GET /api/recipes/favorites**: Отримати список улюблених рецептів.
- **PATCH /api/recipes/favorites**: Додати улюблений рецепт в обрані.
- **DELETE /api/recipes/favorites**: Видалити рецепт за ID.
- **GET /api/recipes/popular**: Отримати список найпопулярніших рецептів.
- **GET /api/recipes/{id}**: Отримати рецепт за ID.
- **GET /api/categories/{id}**: Отримати список категорій рецептів.

#### Список покупок:

- **GET /api/shopping-list**: Отримати список інгредієнтів для покупки.
- **PATCH /api/shopping-list**: Додати інгредієнт до списку покупок.
- **DELETE /api/shopping-list**: Видалити інгредієнт зі списку покупок.

### Аутентифікація та авторизація

API використовує JSON Web Tokens (JWT) для аутентифікації. Щоб отримати доступ, клієнти повинні включити дійсний JWT у заголовок `Authorization`.

Для отримання JWT клієнти спочатку повинні зареєструватися як користувачі через точку доступу `/users/register`, а потім увійти через `/users/login`.

### Приклади запитів та відповідей

API підтримує формат даних JSON як для запитів, так і для відповідей. Ось деякі приклади:

**Запит:**

```http
POST /api/recipes/own HTTP/1.1
Host: https://so-yummi.onrender.com
Authorization: Bearer YOUR_JWT_TOKEN
Content-Type: application/json

{
  "title": "Касероль із куркою Енчілада",
  "category": "Курка",
  "area": "Мексиканський",
  "instructions": "Поріжте кожну курячу грудку на близько 3 шматочки, щоб вона швидше готувалась, і покладіть у маленький каструлю...",
  "description": "Мексиканська касероль з подрібненою куркою, соусом енчілада, тортільями і сиром.",
  "time": "60",
  "youtube": "https://www.youtube.com/watch?v=EtVkwVKLc_M",
  "tags": [],
  "ingredients": [
    {
      "id": "640c2dd963a319ea671e36cb",
      "measure": "14 унцій банка"
    },
    {
      "id": "640c2dd963a319ea671e3767",
      "measure": "3 стакани"
    },
    {
      "id": "640c2dd963a319ea671e36b2",
      "measure": "6"
    },
    {
      "id": "640c2dd963a319ea671e3694",
      "measure": "2"
    }
  ]
}
```

**Відповідь:**

```http
Copy code
HTTP/1.1 201 Created
Content-Type: application/json

{
  "_id": "6462a8f74c3d0ddd28897fc7"
  "title": "Касероль із куркою Енчілада",
  "category": "Курка",
  "area": "Мексиканський",
  "instructions": "Поріжте кожну курячу грудку на близько 3 шматочки, щоб вона швидше готувалась, і покладіть у маленький каструлю...",
  "description": "Мексиканська касероль з подрібненою куркою, соусом енчілада, тортільями і сиром.",
  "thumb": "https://www.themealdb.com/images/media/meals/qtuwxu1468233098.jpg",
  "preview": "https://res.cloudinary.com/ddbvbv5sp/image/upload/v1678560403/smb2tdq5ltv4usbnvmt2.jpg",
  "time": "60",
  "youtube": "https://www.youtube.com/watch?v=EtVkwVKLc_M",
  "tags": [],
  "ingredients": [
    {
      "id": "640c2dd963a319ea671e36cb",
      "measure": "14 унцій банка"
    },
    {
      "id": "640c2dd963a319ea671e3767",
      "measure": "3 стакани"
    },
    {
      "id": "640c2dd963a319ea671e36b2",
      "measure": "6"
    },
    {
      "id": "640c2dd963a319ea671e3694",
      "measure": "2"
    }
  ],
  "owner": "64b626871c338f1e354728cc",
  "favorite": [],
  "createdAt": "2023-07-18T09:31:19.251Z",
  "updatedAt": "2023-07-18T09:31:19.251Z"
}
```

### Обробка помилок

API повертає відповідні статусні коди HTTP і повідомлення про помилку для різних сценаріїв. Наприклад:

- **401 Unauthorized: Електронна адреса або пароль невірний або Електронну адресу не підтверджено..**
- **404 Not Found: Рецепт, інгредієнт не знайдено.**
- **500 Internal Server Error: Помилка сервера.**

### Моделі даних та схема бази даних

Серверний застосунок використовує такі моделі даних:

#### Модель рецептів:

```json
{
"_id": "ObjectId",
"title": "string",
"category": "string",
"area": "string",
"instructions": "string",
"description": "string",
"thumb": "string",
"preview": "string",
"time": "string",
"tags": "array",
"ingredients": [{"id": "ObjectId", "measure": "string"}],
"owner": "ObjectId",
"favorite": ["_user": "ObjectId"],
"createdAt": "date",
"updatedAt": "date"
}
```

#### Модель категорії:

```json
{
  "name": "string"
}
```

#### Модель інгредієнта:

```json
{
  "name": "string",
  "desc": "string",
  "img": "string"
}
```

#### Модель підписки:

```json
{
  "user": "ObejctId",
  "email": "array"
}
```

#### Модель списку покупок:

```json
{
  "ingredientId": "ObejctId",
  "measures": [{ "recipeId": "ObjectId", "measure": "string" }]
}
```

### Версіювання API

API наразі має одну версію.

### Версія 1.0 (Поточна).

Підтримка та контактна інформація
Для будь-яких питань або підтримки, звертайтесь за адресою support@so-yummy.com.

### Ліцензія та умови використання

API надається за ліцензією MIT. Використовуючи API, ви погоджуєтесь дотримуватися умов, визначених у ліцензії.
